# BollingerBand_ETF_LowFreq Optimization Configuration
#
# REVISION STRATEGY - Fix critical fee problems from original
#
# Original Strategy #2 FAILED:
# - 822 trades in 5 years
# - $674 in fees on $1K capital (67% of capital!)
# - Win rate: Only 43%
#
# This revision focuses on:
# - WIDER Bollinger Bands (2-3 std dev) to filter false signals
# - Lower frequency (target 50-150 trades/year, NOT 800+)
# - Entry distance parameter for signal quality tuning
# - Strict fee control: <25% of capital
# - Better win rate: >50%
#
# Total combinations: 4×3×3×4×3 = 432 (Euler Search feasible)

strategy:
  name: "BollingerBand_ETF_LowFreq"
  lean_project_path: "BollingerBand_ETF_LowFreq"
  category: "mean_reversion"
  asset_class: "etf"
  description: "Bollinger Band mean reversion with WIDER bands for low-frequency trading"
  revision_of: "STR-002-original"
  revision_reason: "Fix catastrophic fee problem (67% of capital destroyed)"

backtest:
  start_date: "2020-01-01"
  end_date: "2024-12-31"
  initial_capital: 1000
  resolution: "daily"
  brokerage: "InteractiveBrokers"

optimization:
  type: "Euler Search"
  total_combinations: 432
  target_metric: "Sharpe Ratio"
  target_direction: "max"

  # HARD constraints - must pass ALL to be valid
  constraints:
    - "Drawdown < 0.20"           # Max 20% drawdown
    - "Total Trades >= 50"        # Minimum statistical significance
    - "Fee Pct < 0.25"           # CRITICAL: Fees < 25% of capital (original was 67%!)
    - "Win Rate >= 0.50"         # Better than original 43%

  # Parameter ranges - designed for LOW FREQUENCY
  parameters:
    bb_period:
      description: "Bollinger Band period (longer = fewer signals)"
      start: 15
      end: 30
      step: 5
      values: [15, 20, 25, 30]
      default: 20

    bb_std_dev:
      description: "Bollinger Band standard deviations (WIDER = fewer false signals)"
      start: 2.0
      end: 3.0
      step: 0.5
      values: [2.0, 2.5, 3.0]
      default: 2.5
      note: "WIDER bands are KEY to reducing trade frequency"

    entry_distance_pct:
      description: "How far past lower band to enter (0 = touch band, 0.02 = 2% past)"
      start: 0.00
      end: 0.02
      step: 0.01
      values: [0.00, 0.01, 0.02]
      default: 0.01
      note: "Allows tuning signal quality vs frequency trade-off"

    profit_target_pct:
      description: "Profit target as % of entry price"
      start: 0.015
      end: 0.030
      step: 0.005
      values: [0.015, 0.020, 0.025, 0.030]
      default: 0.020

    stop_loss_pct:
      description: "Stop loss as % of entry price"
      start: 0.010
      end: 0.020
      step: 0.005
      values: [0.010, 0.015, 0.020]
      default: 0.015

# Success criteria - what makes a configuration "good"?
success_criteria:
  # Trade frequency control (KEY improvement over original)
  min_trades: 50
  max_trades: 150
  target_trades_per_year: "50-150 (NOT 800+ like original!)"

  # Performance targets
  min_sharpe: 0.8
  target_sharpe: 1.0
  max_drawdown: 0.20

  # Fee control (CRITICAL IMPROVEMENT)
  max_fee_pct: 0.25
  target_fee_pct: 0.15
  fee_control_strategy: "WIDER bands + daily resolution + entry distance"

  # Win quality
  min_win_rate: 0.50
  min_avg_win: 0.01

  # Risk management
  max_risk_per_trade: 0.01
  max_leverage: 1.0

# Expected optimization results
expected_results:
  total_runs: 432
  estimated_duration: "3-5 hours"
  expected_pass_rate: "30-40%"
  expected_best_sharpe: "0.8-1.2"
  key_insights:
    - "Wider bands (2.5-3.0 std dev) should significantly reduce trade frequency"
    - "entry_distance_pct parameter allows fine-tuning quality vs frequency"
    - "Longer periods (25-30) may work better for low-frequency approach"
    - "Fee percentage should be <25% (vs 67% in original)"
    - "Win rate should improve to >50% with better signal quality"

# Post-optimization analysis queries
analysis:
  fee_impact:
    query: "SELECT bb_std_dev, AVG(fee_pct), AVG(total_trades) FROM results GROUP BY bb_std_dev"
    purpose: "Validate that wider bands reduce fees"

  frequency_vs_sharpe:
    query: "SELECT total_trades, sharpe_ratio FROM results WHERE fee_pct < 0.25 ORDER BY sharpe_ratio DESC"
    purpose: "Find optimal trade frequency range"

  entry_distance_sensitivity:
    query: "SELECT entry_distance_pct, AVG(win_rate), AVG(total_trades) FROM results GROUP BY entry_distance_pct"
    purpose: "Understand entry distance impact on quality vs frequency"